<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Syncing, short for synchronizing, consists in synchronizing the state of a local chain with the state of the chain contained in other machines, called remotes or sources."><title>smoldot::sync - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceSerif4-Regular-46f98efaafac5295.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceSerif4-Bold-a2c9cd1067f8b328.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2"><link rel="stylesheet" href="../../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../../static.files/rustdoc-ba5701c5741a7b69.css" id="mainThemeStyle"><div id="rustdoc-vars" data-root-path="../../" data-static-root-path="../../static.files/" data-current-crate="smoldot" data-themes="" data-resource-suffix="" data-rustdoc-version="1.70.0 (90c541806 2023-05-31)" data-search-js="search-e077946657036a58.js" data-settings-js="settings-298e1ea74db45b39.js" data-settings-css="settings-7bfb4c59cc6bc502.css" data-theme-light-css="light-0f8c037637f9eb3e.css" data-theme-dark-css="dark-1097f8e92a01e3cf.css" data-theme-ayu-css="ayu-614652228113ac93.css" ></div><script src="../../static.files/storage-62ce34ea385b278a.js"></script><script defer src="../../static.files/main-f61008743c98d196.js"></script><noscript><link rel="stylesheet" media="(prefers-color-scheme:light)" href="../../static.files/light-0f8c037637f9eb3e.css"><link rel="stylesheet" media="(prefers-color-scheme:dark)" href="../../static.files/dark-1097f8e92a01e3cf.css"><link rel="stylesheet" href="../../static.files/noscript-13285aec31fa243e.css"></noscript><link rel="alternate icon" type="image/png" href="../../static.files/favicon-16x16-8b506e7a72182f1c.png"><link rel="alternate icon" type="image/png" href="../../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="logo-container" href="../../smoldot/index.html"><img class="rust-logo" src="../../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2></h2></nav><nav class="sidebar"><a class="logo-container" href="../../smoldot/index.html"><img class="rust-logo" src="../../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2 class="location"><a href="#">Module sync</a></h2><div class="sidebar-elems"><section><ul class="block"><li><a href="#modules">Modules</a></li></ul></section></div></nav><main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><a href="../../help.html">?</a></div><div id="settings-menu" tabindex="-1"><a href="../../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../../static.files/wheel-7b819b6101059cd0.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1>Module <a href="../index.html">smoldot</a>::<wbr><a class="mod" href="#">sync</a><button id="copy-path" title="Copy item path to clipboard"><img src="../../static.files/clipboard-7571035ce49a181d.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="srclink" href="../../src/smoldot/sync.rs.html#18-75">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Syncing, short for synchronizing, consists in synchronizing the state of a local chain with
the state of the chain contained in other machines, called <em>remotes</em> or <em>sources</em>.</p>
<blockquote>
<p><strong>Note</strong>: While the above summary is a bit abstract, in practice it is almost always
done by exchanging messages through a peer-to-peer network.</p>
</blockquote>
<p>Multiple strategies exist for syncing, one for each sub-module, and which one to employ
depends on the amount of information that is desired (e.g. is it required to know the header
and/or body of every single block, or can some blocks be skipped?) and the distance between
the highest block of the local chain and the highest block available on the remotes.</p>
<p>The <a href="all/index.html" title="mod smoldot::sync::all"><code>all</code></a> module represents a good combination of all syncing strategies and should be the
default choice for most clients.</p>
<h2 id="security-considerations"><a href="#security-considerations">Security considerations</a></h2><h3 id="eclipse-attacks"><a href="#eclipse-attacks">Eclipse attacks</a></h3>
<p>While there exists various trade-offs between syncing strategies, safety is never part of
these trade-offs. All syncing strategies are safe, in the sense that malicious remotes cannot
corrupt the state of the local chain.</p>
<p>It is possible, however, for a malicious remote to omit some information, such as the
existence of a specific block. If all the remotes that are being synchronized from are
malicious and collude to omit the same information, there is no way for the local node to
learn this information or even to be aware that it is missing an information. This is called
an <strong>eclipse attack</strong>.</p>
<p>For this reason, it is important to ensure a large number and a good distribution of the
sources. In the context of a peer-to-peer network where machines are picked randomly, a
minimum threshold of around 7 peers is generally considered acceptable. Similarly, in the
context of a peer-to-peer network, it is important to establish outgoing connections to other
nodes and not only rely on incoming connections, as there is otherwise the possibility of a
single actor controlling all said incoming connections.</p>
<h3 id="malicious-runtimes"><a href="#malicious-runtimes">Malicious runtimes</a></h3>
<p>Synchronizing the chain requires executing a piece of WebAssembly code known as the runtime.
Each chain has a different runtime, stored on chain, and this runtime can be modified as part
of a the transactions in a block.</p>
<p>There are two safety considerations concerning executing runtime code:</p>
<ul>
<li>The execution could take a lot of time, or possibly be stuck in an infinite loop.</li>
<li>The execution could modify a lot of storage items. Smoldot needs to store every single
storage item change, and a lot of modification could make the memory usage of smoldot explode.</li>
</ul>
<p>The Substrate model, and thus the smoldot implementation, intentionally do not do anything to
address these two safety issues. In other words, the runtime of a chain is considered to never
be malicious. After all, a chain whose runtime is intentionally trying to crash a client is
borked and there is no reason to connect to it.</p>
</div></details><h2 id="modules" class="small-section-header"><a href="#modules">Modules</a></h2><ul class="item-table"><li><div class="item-name"><a class="mod" href="all/index.html" title="mod smoldot::sync::all">all</a></div><div class="desc docblock-short">All syncing strategies (optimistic, warp sync, all forks) grouped together.</div></li><li><div class="item-name"><a class="mod" href="all_forks/index.html" title="mod smoldot::sync::all_forks">all_forks</a></div><div class="desc docblock-short"><em>All-forks</em> header and body syncing.</div></li><li><div class="item-name"><a class="mod" href="optimistic/index.html" title="mod smoldot::sync::optimistic">optimistic</a></div><div class="desc docblock-short">Optimistic header and body syncing.</div></li><li><div class="item-name"><a class="mod" href="para/index.html" title="mod smoldot::sync::para">para</a></div><div class="desc docblock-short">Parachains and parathreads syncing.</div></li><li><div class="item-name"><a class="mod" href="warp_sync/index.html" title="mod smoldot::sync::warp_sync">warp_sync</a></div><div class="desc docblock-short">Warp syncing.</div></li></ul></section></div></main></body></html>